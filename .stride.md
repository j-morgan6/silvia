# Stride Hook Configuration

This file defines the hooks that execute at different points in the task lifecycle.

## Hook Environment Variables

All hooks receive these environment variables:
- `TASK_ID`, `TASK_IDENTIFIER`, `TASK_TITLE`, `TASK_DESCRIPTION`
- `TASK_STATUS`, `TASK_COMPLEXITY`, `TASK_PRIORITY`, `TASK_NEEDS_REVIEW`
- `BOARD_ID`, `BOARD_NAME`, `COLUMN_ID`, `COLUMN_NAME`
- `AGENT_NAME`, `HOOK_NAME`

## before_doing

Executes before starting work on a task (blocking, 60 seconds).
Typical uses: Pull latest code, setup environment, verify dependencies.

```bash
#!/bin/bash
set -e

echo "ðŸ”„ Pulling latest changes..."
git pull origin main

echo "ðŸ“¦ Fetching dependencies..."
mix deps.get

echo "âœ… Ready to start task: $TASK_TITLE"
```

## after_doing

Executes after completing work (blocking, 120 seconds).
Typical uses: Run tests, linting, building. Must pass for task completion.

```bash
#!/bin/bash
set -e

echo "ðŸ§ª Running tests..."
mix test

echo "ðŸ” Running formatter check..."
mix format --check-formatted

echo "ðŸ“Š Running code analysis..."
mix credo --strict

echo "âœ… All checks passed for task: $TASK_TITLE"
```

## before_review

Executes when task enters review (non-blocking, 60 seconds).
Typical uses: Create pull request, generate documentation.

```bash
#!/bin/bash
set -e

echo "ðŸ“ Creating pull request for task: $TASK_TITLE"

# Create a branch name from task identifier
BRANCH_NAME="stride-task-${TASK_IDENTIFIER}"

# Ensure we're on a feature branch
if [ "$(git branch --show-current)" != "$BRANCH_NAME" ]; then
  echo "âš ï¸  Warning: Not on expected branch $BRANCH_NAME"
fi

# Push to remote
git push origin HEAD

# Create PR if gh CLI is available
if command -v gh &> /dev/null; then
  gh pr create --title "$TASK_TITLE" --body "$TASK_DESCRIPTION" || echo "PR may already exist"
fi

echo "âœ… Ready for review"
```

## after_review

Executes after review approval (non-blocking, 60 seconds).
Typical uses: Merge changes, deploy to production, cleanup.

```bash
#!/bin/bash
set -e

echo "ðŸŽ‰ Task approved: $TASK_TITLE"

# Merge to main if gh CLI is available
if command -v gh &> /dev/null; then
  BRANCH_NAME="stride-task-${TASK_IDENTIFIER}"
  gh pr merge --merge --delete-branch || echo "Manual merge may be required"
fi

echo "âœ… Task complete and merged"
```
